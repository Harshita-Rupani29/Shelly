#!/usr/bin/env node

/**
 * Format Changelog Script
 *
 * This script formats the CHANGELOG.md file after it's generated by semantic-release.
 * It's designed to be run as part of the release process to ensure consistent formatting.
 */

const { execSync } = require('child_process');
const fs = require('fs');
const path = require('path');

function formatChangelog() {
  console.log('üìÑ Formatting CHANGELOG.md...');

  const changelogPath = path.join(process.cwd(), 'CHANGELOG.md');

  // Check if CHANGELOG.md exists
  if (!fs.existsSync(changelogPath)) {
    console.log('‚ö†Ô∏è  CHANGELOG.md not found, skipping formatting');
    return;
  }

  try {
    // Run prettier on CHANGELOG.md
    execSync('npx prettier --write CHANGELOG.md', {
      stdio: 'inherit',
      cwd: process.cwd(),
    });

    console.log('‚úÖ CHANGELOG.md formatted successfully');
  } catch (error) {
    console.error('‚ùå Error formatting CHANGELOG.md:', error.message);
    process.exit(1);
  }
}

// Run if called directly
if (require.main === module) {
  formatChangelog();
}

module.exports = { formatChangelog };
